{"ast":null,"code":"import React,{useEffect}from'react';import{Link}from'react-router-dom';import{Button,Row,Col,ListGroup,Image,Card}from'react-bootstrap';import{useSelector,useDispatch}from'react-redux';import Message from'../components/Message';import CheckoutSteps from'../components/CheckoutSteps';import{createOrder}from'../actions/orderActions';var addDecimals=function addDecimals(num){return(Math.round(num*100)/100).toFixed(2);};var PlaceOrderScreen=function PlaceOrderScreen(_ref){var _cart$shippingAddress,_cart$shippingAddress2,_cart$shippingAddress3,_cart$shippingAddress4;var history=_ref.history;var cart=useSelector(function(state){return state.cart;});var dispatch=useDispatch();cart.itemsPrice=addDecimals(cart.cartItems.reduce(function(acc,item){return acc+item.price*item.qty;},0));cart.shippingPrice=addDecimals(cart.itemsPrice>100?0:100);cart.taxPrice=addDecimals(Number((0.15*cart.itemsPrice).toFixed(2)));cart.totalPrice=addDecimals(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice));var _useSelector=useSelector(function(state){return state.orderCreate;}),order=_useSelector.order,success=_useSelector.success,error=_useSelector.error;useEffect(function(){if(success){history.push(\"/order/\".concat(order._id));}//eslint-disable-next-line\n},[history,success]);var placeOrderHandler=function placeOrderHandler(){dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:8},/*#__PURE__*/React.createElement(ListGroup,{variant:\"flush\"},/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Shipping\"),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Address:\"),(_cart$shippingAddress=cart.shippingAddress)===null||_cart$shippingAddress===void 0?void 0:_cart$shippingAddress.address,\",\",(_cart$shippingAddress2=cart.shippingAddress)===null||_cart$shippingAddress2===void 0?void 0:_cart$shippingAddress2.city,\" \",(_cart$shippingAddress3=cart.shippingAddress)===null||_cart$shippingAddress3===void 0?void 0:_cart$shippingAddress3.postalCode,\",\",' ',(_cart$shippingAddress4=cart.shippingAddress)===null||_cart$shippingAddress4===void 0?void 0:_cart$shippingAddress4.country)),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Payment Method\"),/*#__PURE__*/React.createElement(\"strong\",null,\"Method:\"),cart.paymentMethod),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Order Items\"),/*#__PURE__*/React.createElement(\"strong\",null,\"Method:\"),!cart.cartItems.length?/*#__PURE__*/React.createElement(Message,null,\"Your cart is empty\"):/*#__PURE__*/React.createElement(ListGroup,{variant:\"flush\"},cart.cartItems.map(function(item,index){return/*#__PURE__*/React.createElement(ListGroup.Item,{key:index},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:1},/*#__PURE__*/React.createElement(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Link,{to:\"/product/\".concat(item.product)},item.name)),/*#__PURE__*/React.createElement(Col,{md:4},item.qty,\" x $\",item.price,\" = $\",item.qty*item.price)));}))))),/*#__PURE__*/React.createElement(Col,{md:4},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(ListGroup,{variant:\"flush\"},/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Order Summary\")),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,\"Items\"),/*#__PURE__*/React.createElement(Col,null,\"$\",cart.itemsPrice))),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,\"Shipping\"),/*#__PURE__*/React.createElement(Col,null,\"$\",cart.shippingPrice))),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,\"Tax\"),/*#__PURE__*/React.createElement(Col,null,\"$\",cart.taxPrice))),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,\"Total\"),/*#__PURE__*/React.createElement(Col,null,\"$\",cart.totalPrice))),error&&/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Message,{variant:\"danger\"},error)),/*#__PURE__*/React.createElement(ListGroup.Item,null,/*#__PURE__*/React.createElement(Button,{type:\"Button\",className:\"btn-block\",disabled:!cart.cartItems,onClick:placeOrderHandler},\"Place Order\")))))));};export default PlaceOrderScreen;","map":{"version":3,"sources":["/home/ad.rapidops.com/kishor.rathva/Worspace/hapi-mongo-ts/client/src/screens/PlaceOrderScreen.tsx"],"names":["React","useEffect","Link","Button","Row","Col","ListGroup","Image","Card","useSelector","useDispatch","Message","CheckoutSteps","createOrder","addDecimals","num","Math","round","toFixed","PlaceOrderScreen","history","cart","state","dispatch","itemsPrice","cartItems","reduce","acc","item","price","qty","shippingPrice","taxPrice","Number","totalPrice","orderCreate","order","success","error","push","_id","placeOrderHandler","orderItems","shippingAddress","paymentMethod","address","city","postalCode","country","length","map","index","image","name","product"],"mappings":"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","sourcesContent":["import React, { FunctionComponent, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Button, Row, Col, ListGroup, Image, Card } from 'react-bootstrap';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Message from '../components/Message';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport { createOrder } from '../actions/orderActions';\n\ninterface Props {\n  history: any;\n}\n\nconst addDecimals = (num: number) => {\n  return (Math.round(num * 100) / 100).toFixed(2);\n};\n\nconst PlaceOrderScreen: FunctionComponent<Props> = ({ history }) => {\n  const cart = useSelector((state: any) => state.cart);\n  const dispatch = useDispatch();\n\n  cart.itemsPrice = addDecimals(cart.cartItems.reduce((acc: any, item: any) => acc + item.price * item.qty, 0));\n  cart.shippingPrice = addDecimals(cart.itemsPrice > 100 ? 0 : 100);\n  cart.taxPrice = addDecimals(Number((0.15 * cart.itemsPrice).toFixed(2)));\n  cart.totalPrice = addDecimals(Number(cart.itemsPrice) + Number(cart.shippingPrice) + Number(cart.taxPrice));\n\n  const { order, success, error } = useSelector((state: any) => state.orderCreate);\n\n  useEffect(() => {\n    if (success) {\n      history.push(`/order/${order._id}`);\n    }\n    //eslint-disable-next-line\n  }, [history, success]);\n\n  const placeOrderHandler = () => {\n    dispatch(\n      createOrder({\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        paymentMethod: cart.paymentMethod,\n        itemsPrice: cart.itemsPrice,\n        shippingPrice: cart.shippingPrice,\n        taxPrice: cart.taxPrice,\n        totalPrice: cart.totalPrice,\n      })\n    );\n  };\n\n  return (\n    <>\n      <CheckoutSteps step1 step2 step3 step4 />\n      <Row>\n        <Col md={8}>\n          <ListGroup variant=\"flush\">\n            <ListGroup.Item>\n              <h2>Shipping</h2>\n              <p>\n                <strong>Address:</strong>\n                {cart.shippingAddress?.address},{cart.shippingAddress?.city} {cart.shippingAddress?.postalCode},{' '}\n                {cart.shippingAddress?.country}\n              </p>\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <h2>Payment Method</h2>\n              <strong>Method:</strong>\n              {cart.paymentMethod}\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <h2>Order Items</h2>\n              <strong>Method:</strong>\n              {!cart.cartItems.length ? (\n                <Message>Your cart is empty</Message>\n              ) : (\n                <ListGroup variant=\"flush\">\n                  {cart.cartItems.map((item: any, index: number) => (\n                    <ListGroup.Item key={index}>\n                      <Row>\n                        <Col md={1}>\n                          <Image src={item.image} alt={item.name} fluid rounded />\n                        </Col>\n                        <Col>\n                          <Link to={`/product/${item.product}`}>{item.name}</Link>\n                        </Col>\n                        <Col md={4}>\n                          {item.qty} x ${item.price} = ${item.qty * item.price}\n                        </Col>\n                      </Row>\n                    </ListGroup.Item>\n                  ))}\n                </ListGroup>\n              )}\n            </ListGroup.Item>\n          </ListGroup>\n        </Col>\n        <Col md={4}>\n          <Card>\n            <ListGroup variant=\"flush\">\n              <ListGroup.Item>\n                <h2>Order Summary</h2>\n              </ListGroup.Item>\n              <ListGroup.Item>\n                <Row>\n                  <Col>Items</Col>\n                  <Col>${cart.itemsPrice}</Col>\n                </Row>\n              </ListGroup.Item>\n              <ListGroup.Item>\n                <Row>\n                  <Col>Shipping</Col>\n                  <Col>${cart.shippingPrice}</Col>\n                </Row>\n              </ListGroup.Item>\n              <ListGroup.Item>\n                <Row>\n                  <Col>Tax</Col>\n                  <Col>${cart.taxPrice}</Col>\n                </Row>\n              </ListGroup.Item>\n              <ListGroup.Item>\n                <Row>\n                  <Col>Total</Col>\n                  <Col>${cart.totalPrice}</Col>\n                </Row>\n              </ListGroup.Item>\n              {error && (\n                <ListGroup.Item>\n                  <Message variant=\"danger\">{error}</Message>\n                </ListGroup.Item>\n              )}\n              <ListGroup.Item>\n                <Button type=\"Button\" className=\"btn-block\" disabled={!cart.cartItems} onClick={placeOrderHandler}>\n                  Place Order\n                </Button>\n              </ListGroup.Item>\n            </ListGroup>\n          </Card>\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nexport default PlaceOrderScreen;\n"]},"metadata":{},"sourceType":"module"}