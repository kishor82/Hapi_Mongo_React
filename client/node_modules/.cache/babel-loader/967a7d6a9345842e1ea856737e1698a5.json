{"ast":null,"code":"import _regeneratorRuntime from\"/home/ad.rapidops.com/kishor.rathva/Worspace/hapi-mongo-ts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ad.rapidops.com/kishor.rathva/Worspace/hapi-mongo-ts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ad.rapidops.com/kishor.rathva/Worspace/hapi-mongo-ts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import axios from'axios';import{Link,useHistory,useParams}from'react-router-dom';import{Form,Button}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import Message from'../components/Message';import Loader from'../components/Loader';import FormContainer from'../components/FormContainer';import{listProductDetails,updateProduct}from'../actions/productActions';import{PRODUCT_UPDATE_RESET}from'../constants/productConstants';var ProductEditScreen=function ProductEditScreen(){var history=useHistory();var _useParams=useParams(),productId=_useParams.id;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),price=_useState4[0],setPrice=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),brand=_useState8[0],setBrand=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),countInStock=_useState12[0],setCountInStock=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),description=_useState14[0],setDescription=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),uploading=_useState16[0],setUploading=_useState16[1];var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.productDetails;}),loading=_useSelector.loading,error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.productUpdate;}),loadingUpdate=_useSelector2.loading,errorUpdate=_useSelector2.error,successUpdate=_useSelector2.success;var _useSelector3=useSelector(function(state){return state.userLogin;}),userInfo=_useSelector3.userInfo;useEffect(function(){if(successUpdate){dispatch({type:PRODUCT_UPDATE_RESET});history.push('/admin/productlist');}else{if(!product.name||product._id!==productId){dispatch(listProductDetails(productId));}else{setName(product.name);setPrice(product.price);setImage(product.image);setBrand(product.brand);setCategory(product.category);setCountInStock(product.countInStock);setDescription(product.description);}}},[product,productId,dispatch,history,successUpdate]);var submitHandler=function submitHandler(e){e.preventDefault();dispatch(updateProduct(productId,{name:name,price:price,image:image,brand:brand,category:category,countInStock:countInStock,description:description}));};var uploadFileHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];formData=new FormData();formData.append('file',file);setUploading(true);_context.prev=4;config={headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(userInfo===null||userInfo===void 0?void 0:userInfo.token)}};_context.next=8;return axios.post('/upload',formData,config);case 8:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setImage(data);setUploading(false);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](4);setUploading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[4,14]]);}));return function uploadFileHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Link,{to:\"/admin/productlist\",className:\"btn btn-light my-3\"},\"Go Back\"),/*#__PURE__*/React.createElement(FormContainer,null,/*#__PURE__*/React.createElement(\"h1\",null,\"Edit Product\"),loadingUpdate&&/*#__PURE__*/React.createElement(Loader,null),errorUpdate&&/*#__PURE__*/React.createElement(Message,{variant:\"danger\"},errorUpdate),loading?/*#__PURE__*/React.createElement(Loader,null):error?/*#__PURE__*/React.createElement(Message,{variant:\"danger\"},error):/*#__PURE__*/React.createElement(Form,{onSubmit:submitHandler},/*#__PURE__*/React.createElement(Form.Group,{controlId:\"name\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Name\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:\"Enter name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"price\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Price\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",placeholder:\"Enter price\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"image\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Image\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:\"Enter Image url\",value:image,onChange:function onChange(e){return e.target.value?setImage(e.target.value):setImage('/images/sample.png');}}),/*#__PURE__*/React.createElement(Form.File,{id:\"image-file\",label:\"Choose File\",custom:true,onChange:uploadFileHandler}),uploading&&/*#__PURE__*/React.createElement(Loader,null)),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"brand\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Brand\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:\"Enter brand\",value:brand,onChange:function onChange(e){return setBrand(e.target.value);}})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"countInStock\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Count In Stock\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",placeholder:\"Enter countInStock\",value:countInStock,onChange:function onChange(e){return setCountInStock(e.target.value);}})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"category\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Category\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:\"Enter Category\",value:category,onChange:function onChange(e){return setCategory(e.target.value);}})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"description\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Description\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:\"Enter description\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})),/*#__PURE__*/React.createElement(Button,{type:\"submit\",variant:\"primary\"},\"Update\"))));};export default ProductEditScreen;","map":null,"metadata":{},"sourceType":"module"}